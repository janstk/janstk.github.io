<html>

	<head>
		<title></title>
		<meta charset="UTF-8" />
	</head>
	<script type="text/javascript">
		//这里定义列表项中的元素开始id.
		var entryId = 1;
		window.addEventListener('load',function()
		{
			//获取元素
			var addBtn = document.getElementById('add');
			var delAll = document.getElementById('delAll');
			var checkAll = document.getElementById('all');
			//获取table的根节点
			var tab = document.getElementById('tab');
			//添加事件方法
			addBtn.addEventListener('click',function(){
				var name = document.getElementById('username').value
				var age = document.getElementById('age').value;
				var score = document.getElementById('score').value;
				var regNum = /^\d+$/;
				if(name && regNum.test(age) && regNum.test(score))
				{
					//这里执行add方法
					add(name,age,score);
				}else{
					alert("请输入正确的信息！");
				}
			});
			//批量选中项目
			checkAll.addEventListener('click',function(){
					var allChild = tab.getElementsByTagName('tr')
					for (var i = 1; i < allChild.length; i++) {
						var current = allChild[i].getElementsByTagName('td');
						var check = current[0].getElementsByTagName("input");
						check[0].checked = checkAll.checked;
					}
			});
			//删除所有选中项目
			delAll.addEventListener('click',function(){ 
		
				var allChild = document.getElementsByName('row');
				var count = 0;
				console.log(allChild.length);
				var i = 0;
				while(i<allChild.length)
				{
					if(allChild[i].checked)
					{
						removeMe(allChild[i].parentNode.parentNode);
						i = 0;
						count++;
					}else
						i++;
				}
				console.log(count);
			});
			
		});
		function add(name,age,score)
		{
			
			var newEntry = document.createElement('tr');
			newEntry.setAttribute('id',"entry_"+entryId);
			//添加复选框
			var checkEntry = document.createElement('input');
			checkEntry.setAttribute('type','checkbox');
			checkEntry.setAttribute('name','row');
			var checkTd = document.createElement('td');
			checkTd.appendChild(checkEntry);
			newEntry.appendChild(checkTd);
			//添加内容
			//name
			var nameEntry = document.createElement('td');
			nameEntry.innerHTML = name;
			newEntry.appendChild(nameEntry);
			//age
			var ageEntry = document.createElement('td');
			ageEntry.innerHTML = age;
			newEntry.appendChild(ageEntry);
			//score
			var scoreEntry = document.createElement('td');
			scoreEntry.innerHTML = score;
			newEntry.appendChild(scoreEntry);
			//删除链接
			var delMeEntry = document.createElement('td');
			var anthorEntry = document.createElement('a');
			anthorEntry.setAttribute('href','#');
			anthorEntry.setAttribute('onclick',"delMe('entry_"+entryId+"')");
			anthorEntry.innerHTML="删除";
			delMeEntry.appendChild(anthorEntry);
			newEntry.appendChild(delMeEntry);
			
			tab.appendChild(newEntry);
			entryId++;
			
		}
		function delMe(entryNum)
		{
			var delElem = document.getElementById(entryNum);
			var retConfirm = confirm("确定删除？")
			if(retConfirm)
				removeMe(delElem);
		}
		function removeMe(node) {
			var parent = node.parentNode;
			parent.removeChild(node);
		}
	</script>

	<body>
		<div>
			姓名:
			<input type="text" id="username" />
			<br/> 年龄:
			<input type="text" id="age" />
			<br/> 成绩:
			<input type="text" id="score" />
			<br/>
		</div>
		<br />
		<button id="add">添加</button>

		<hr size="2" />
		<table border="" cellspacing="" cellpadding="" >
			<tbody id="tab">
			<tr>
				<th>
					<input type="checkbox" id="all">
				</th>
				<th>姓名</th>
				<th>年龄</th>
				<th>成绩</th>
				<th>操作</th>
			</tr>
			<tr id="entry_0">
				<td>
					<input type="checkbox" name="row">
				</td>
				<td>张三</td>
				<td>23</td>
				<td>89</td>
				<td><a href="#" onclick="delMe('entry_0')">删除</a></td>
			</tr>
			</tbody>
		</table>
		<br/>
		<button id="delAll">批量删除</button>
	</body>

</html>