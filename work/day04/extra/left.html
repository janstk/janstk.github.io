<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title></title>
		<script type="application/javascript" src="main.js"></script>
		<script type="text/javascript">
			window.name = "left";
			var dataWindow;
			window.addEventListener('load', function() {
				//获取事件源
				var genderBtn = document.getElementById('selectGender');
				var submitBtn = document.getElementById("submit");
				//获取另一个窗口
				dataWindow = parent.document.getElementById('right');
				dataWindow = dataWindow.contentDocument;
				//初始化另一个窗口的事件
				addAnthorEvent();
				//添加事件。
				//选择性别
				genderBtn.addEventListener('click', function() {
					window.open("gender.html", '', 'width=100,height=100');
				});
				//提交...
				submitBtn.addEventListener('click', function() {
					var name = document.getElementById("name").value;
					var age = document.getElementById('age').value;
					var gender = document.getElementById('gender').value;
					var newEntry = new Entry(name, age, gender);
					// console.log(newEntry);
					var tab = dataWindow.getElementById('tab');
					if (newEntry.isAvail()) {
						add(newEntry, tab);
					} else {
						alert("请输入正确的信息！");
					}
				});
			});

			function add(newEntry, tab) {
				var tabEntry = document.createElement('tr');
				tabEntry.innerHTML = '<td><input type="checkbox" name="row"></td><tr><td>' + newEntry.username + '</td><td>' + newEntry.age + '</td><td>' + newEntry.gender + '</td><td><a href="#" name="delMe">删除</a></td></tr>';
				tab.appendChild(tabEntry);
				addAnthorEvent();
			}
			function addAnthorEvent() {
				var delMe = dataWindow.getElementsByName("delMe");
				for (var x = 0; x < delMe.length; x++) {
					if (!delMe[x].onclick)
						delMe[x].addEventListener('click', function() {
							delNode(this.parentNode.parentNode);
						});
				}
			}
		</script>
		<style type="text/css">
			input {
				width: 80px;
			}
		</style>
	</head>

	<body>
		姓名:
		<input type="text" id="name" />
		<br /> 年龄:
		<input type="text" id="age" />
		<br /> 性别:
		<input type="text" disabled="disabled" id="gender" />
		<button id="selectGender">选择性别</button>
		<br />
		<hr/>
		<button id="submit">提交</button>

	</body>

</html>